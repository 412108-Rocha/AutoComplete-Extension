<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Mapper</title>
    <style>
        :root {
            --bg: #0b0f14;
            --panel: #121820;
            --panel-2: #15202b;
            --text: #e6edf3;
            --muted: #9aa7b2;
            --border: #223042;
            --primary: #3b82f6;
            --primary-600: #2563eb;
            --success: #22c55e;
            --warn: #f59e0b;
            --error: #ef4444;
            --radius: 10px;
            --shadow: 0 6px 18px rgba(0,0,0,.25);
        }
        /* Layout base */
        html, body { margin: 0; padding: 0; }
        body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji"; padding: 12px; width: 400px; color: var(--text); background: var(--bg); }
        h3 { margin: 6px 0 10px; font-size: 14px; letter-spacing: .3px; color: var(--text); }
        section { border: 1px solid var(--border); border-radius: var(--radius); padding: 12px; margin-bottom: 12px; background: var(--panel); box-shadow: var(--shadow); }

        /* Tabs */
        .tabs { display: flex; gap: 6px; margin-bottom: 10px; flex-wrap: wrap; }
        .tab { flex: 1; text-align: center; padding: 8px 10px; cursor: pointer; background: transparent; border: 1px solid var(--border); color: var(--muted); border-radius: 8px; transition: all .2s ease; font-weight: 600; }
        .tab:hover { border-color: #2c3e50; color: var(--text); background: rgba(255,255,255,.03); }
        .tab.active { background: var(--panel); color: var(--text); border-color: #2e3c4a; box-shadow: var(--shadow); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Utilidades */
        .row { display: flex; gap: 8px; align-items: center; margin: 8px 0; }
        .row > * { flex: 1; }
        .split { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .grow { flex: 1; }
        .divider { height: 1px; background: var(--border); margin: 10px 0; }
        small.muted { color: var(--muted); }

        /* Formularios */
        .form { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .field { display: flex; flex-direction: column; gap: 6px; background: var(--panel-2); padding: 8px; border-radius: 8px; border: 1px solid var(--border); }
        .field label { font-size: 12px; font-weight: 600; color: var(--muted); }
        input[type="text"], input[type="number"], select { padding: 10px 10px; border: 1px solid var(--border); border-radius: 8px; outline: none; background: #0e141b; color: var(--text); transition: border-color .15s, box-shadow .15s; }
        input[type="text"]:focus, input[type="number"]:focus, select:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59,130,246,.15); }
        .actions { display: flex; justify-content: flex-end; gap: 8px; }

        /* Listas */
        ul { list-style: none; padding-left: 0; margin: 6px 0; }
        li { display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 8px; background: var(--panel-2); border: 1px solid var(--border); border-radius: 8px; }
        li + li { margin-top: 6px; }
        .cat { font-weight: 700; margin: 10px 0 6px; color: var(--text); }

        /* Botones */
        button { padding: 8px 12px; cursor: pointer; border-radius: 8px; border: 1px solid var(--border); background: #0e141b; color: var(--text); transition: transform .03s ease, background .15s, border-color .15s; }
        button:hover { background: #121922; border-color: #2c3e50; }
        button:active { transform: translateY(1px); }
        .btn-primary { background: linear-gradient(180deg, var(--primary), var(--primary-600)); border-color: #1e40af; color: #fff; }
        .btn-primary:hover { background: linear-gradient(180deg, var(--primary-600), #1d4ed8); }
        .btn-danger { background: linear-gradient(180deg, #f87171, #ef4444); color: #fff; border-color: #b91c1c; }

        /* Pills/estados */
        .pill { font-size: 12px; color: #fff; padding: 2px 10px; border-radius: 999px; border: 1px solid rgba(255,255,255,.15); }
        .pill.ok { background: #16a34a; }
        .pill.warn { background: #f59e0b; color: #1b1b1b; }
        .pill.err { background: #ef4444; }
        .kbd { background: #111720; border: 1px solid var(--border); border-radius: 6px; padding: 2px 6px; color: var(--muted); }
    </style>
</head>
<body>
<h3>Mapper</h3>

<div class="tabs" role="tablist">
    <button class="tab" data-target="inicio" role="tab">Inicio</button>
    <button class="tab" data-target="campos" role="tab">Campos</button>
    <button class="tab" data-target="mapeo" role="tab">Mapeo</button>
    <button class="tab" data-target="config" role="tab">Atajos y Config</button>
    <button class="tab" data-target="ayuda" role="tab">Tutoriales</button>
</div>

<section id="inicio" class="tab-content" data-tab="inicio">
    <div class="row"><strong>Acciones rápidas</strong></div>
    <div class="split">
        <button id="btnCopiar" class="btn-primary">Copiar</button>
        <button id="btnPegar" class="btn-primary">Pegar</button>
    </div>
    <div class="divider"></div>
    <div class="row"><strong>Portapapeles</strong></div>
    <div class="row"><span id="estadoClip" class="pill">—</span><span id="tiempoClip"></span></div>
    <ul id="listaClip"></ul>
    <div class="actions"><button id="vaciarClip" class="btn-danger">Vaciar portapapeles</button></div>
</section>

<section id="campos" class="tab-content" data-tab="campos">
    <div class="row"><strong>Campos mapeables</strong></div>
    <!-- Formulario en filas -->
    <div class="form" id="formCampo">
        <div class="field">
            <label for="campoCategoria">Tipo de campo</label>
            <select id="campoCategoria">
                <option value="texto">Texto</option>
                <option value="numeros">Números</option>
                <option value="fechas">Fechas</option>
                <option value="booleanos">Booleanos</option>
                <option value="select">Select</option>
                <option value="textoLargo">Texto largo</option>
            </select>
        </div>
        <div class="field">
            <label for="campoNombre">Nombre</label>
            <input id="campoNombre" type="text" placeholder="ej: nombre" />
        </div>
        <div class="field">
            <label for="campoCodigo">Código único</label>
            <input id="campoCodigo" type="text" placeholder="ej: nom" />
            <small id="hintCodigo" class="muted">Texto libre. Para Números: solo dígitos. Para Fechas: YYYY-MM-DD. Booleanos: true/false/1/0/si/no.</small>
        </div>
        <div class="actions">
            <button id="agregarCampo" class="btn-primary">Agregar</button>
        </div>
    </div>
    <small class="muted">Los campos existentes están bloqueados; para cambiarlos, usá Editar y luego Guardar/Cancelar.</small>
    <div id="listaCampos"></div>
</section>

<section id="mapeo" class="tab-content" data-tab="mapeo">
    <div class="row"><strong>Mapeo por dominio</strong></div>
    <div class="split">
        <button id="mapearCopiar" class="btn-primary">Mapear para copiar</button>
        <button id="mapearPegar" class="btn-primary">Mapear para pegar</button>
    </div>
    <div class="actions"><button id="borrarMapeoDominio" class="btn-danger">Borrar mapeo del dominio</button></div>
</section>

<section id="config" class="tab-content" data-tab="config">
    <div class="row"><strong>Preferencias</strong></div>
    <div class="row">
        <label class="grow"><input type="checkbox" id="notifsChk" /> Notificaciones nativas</label>
    </div>
    <div class="divider"></div>
    <div class="row"><strong>Atajos</strong></div>
    <div class="row">
        <label class="grow"><input type="checkbox" id="cmdsChk" /> Atajos activos</label>
        <div>
            <div><small class="muted">Copiar: <span class="kbd">Ctrl</span> + <span class="kbd">Shift</span> + <span class="kbd">C</span></small></div>
            <div><small class="muted">Pegar: <span class="kbd">Ctrl</span> + <span class="kbd">Shift</span> + <span class="kbd">V</span></small></div>
        </div>
    </div>
    <div class="actions"><button id="abrirAtajos">Abrir página de atajos…</button></div>
    <div class="divider"></div>
    <div class="row"><strong>Backup</strong></div>
    <div class="split">
        <button id="exportar">Exportar JSON</button>
        <button id="importar">Importar JSON</button>
        <input type="file" id="importFile" accept="application/json" style="display:none;" />
    </div>
    <div class="actions"><button id="guardarConfig" class="btn-primary">Guardar configuración</button></div>
</section>

<section id="ayuda" class="tab-content" data-tab="ayuda">
    <div class="row"><strong>Tutoriales</strong></div>
    <ol>
        <li><strong>Conceptos clave</strong>
            <ul>
                <li>Campo: dato que querés copiar/pegar (ej.: nombre, DNI).</li>
                <li>Código: identificador único que usás para reconocer un input al mapear.</li>
                <li>Expiración: los datos copiados se borran automáticamente a los 45s.</li>
            </ul>
        </li>
        <li><strong>Definir campos</strong> (pestaña Campos)
            <ul>
                <li>Elegí el tipo, poné nombre y código único → Agregar.</li>
                <li>Para cambiar un código existente: Editar → Guardar/Cancelar.</li>
            </ul>
        </li>
        <li><strong>Mapear</strong> (pestaña Mapeo)
            <ul>
                <li>En ORIGEN: completá los inputs con tus códigos → “Mapear para copiar”.</li>
                <li>En DESTINO: ubicá los inputs que recibirán los valores → “Mapear para pegar”.</li>
                <li>Podés sobrescribir o borrar el mapeo de un dominio cuando quieras.</li>
            </ul>
        </li>
        <li><strong>Usar</strong> (pestaña Inicio)
            <ul>
                <li>Copiá en ORIGEN y Pegá en DESTINO; revisá el portapapeles y su tiempo restante.</li>
                <li>Atajos: Ctrl+Shift+C / Ctrl+Shift+V (si están activos).</li>
                <li>Fechas: admite hoy, ayer, +3d, -2d o YYYY-MM-DD.</li>
            </ul>
        </li>
        <li><strong>Backup</strong> (pestaña Atajos y Config)
            <ul>
                <li>Exportá/Importá tu configuración en JSON para migrarla entre equipos.</li>
            </ul>
        </li>
    </ol>
</section>

<script src="popup.js"></script>
</body>
</html>
